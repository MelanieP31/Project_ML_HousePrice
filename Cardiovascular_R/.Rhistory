setwd("C:/Users/melan/Desktop/DeveloppementInfo/Portfolio/Projects ML/Cardiovascular_R")
#data <- read.csv("data.csv", sep = ",")
data <- read.csv(url("https://archive.ics.uci.edu/ml/machine-learning-databases/heart-disease/processed.cleveland.data"), header = FALSE)
View(data)
#Renomer les colonnes
colnames(data) <- c("age","sex","cp","trestbps","chol","restecg","thalac","exang","oldpeak","slope","ca","thal","target")
#Renomer les colonnes
colnames(data) <- c("age","sex","cp","trestbps","chol","fbs","restecg","thalac","exang","oldpeak","slope","ca","thal","target")
#Nettoyer les données
data$target[data$target==2] <- 1
data$target[data$target==3] <- 1
data$target[data$target==4] <- 1
#valeur manquante
which(data %in% "?")
#valeur manquante
which(data$ca %in% "?")
which(data$thal %in% "?")
valeur_manquantes <- c(which(data$thal %in% "?"),which(data$ca %in% "?"))
valeur_manquantes
data <- data[-valeur_manquantes,]
#codage type de données
str(data)
## varibale qualitative
data$sex <- as.factor(data$sex)
#codage type de données
str(data)
data$sex <- as.factor(data$sex)
data$cp <- as.factor(data$cp)
data$fbs <- as.factor(data$fbs)
data$restecg <- as.factor(data$restecg)
data$exang <- as.factor(data$exang)
data$slope <- as.factor(data$slope)
data$ca <- as.factor(data$ca)
data$thal <- as.factor(data$thal)
data$target <- as.factor(data$target)
data$age <- as.integer(data$age)
data$threstbps <- as.integer(data$threstbps)
#codage type de données
str(data)
data$chol <- as.integer(data$chol)
data$age <- as.integer(data$age)
data$trestbps <- as.integer(data$trestbps)
data$chol <- as.integer(data$chol)
data$thalac <- as.integer(data$thalac)
#codage type de données
str(data)
#recodage des variables
levels(data$sex)
#recodage des variables
levels(data$sex) <- c("Femme","Homme")
levels(data$sex) <- c("Femme","Homme")
levels(data$cp) <- c("Angine stable","Angine instable","Autres douleurs","Asymptomatique")
levels(data$fbs) <- c("Non","Oui")
levels(data$restecg) <- c("Normal","Anomalies","Hypertrophie")
levels(data$exang) <- c("Non","Oui")
levels(data$sex) <- c("Femme","Homme")
levels(data$cp) <- c("Angine stable","Angine instable","Autres douleurs","Asymptomatique")
levels(data$fbs) <- c("Non","Oui")
levels(data$restecg) <- c("Normal","Anomalies","Hypertrophie")
levels(data$exang) <- c("Non","Oui")
levels(data$slope) <- c("En hausse","Stable","En baisse")
levels(data$ca) <- c("Absence d'anomalie","Faible","Moyen","Elevé")
levels(data$thal) <- c("Non","Thal sous contrôle","Thal instable")
levels(data$target) <- c("Non","Oui")
str(data)
#valeur manquante
apply(data,2, anyNA)
#Indicateurs clés (qualitatif)
table(data$sex)
prop.table(table(data$sex))
round(prop.table(table(data$sex)),4)
round(prop.table(table(data$sex)),4)*100
table(data$cp)
round(prop.table(table(data$cp)),4)*100
table(data$fbs)
round(prop.table(table(data$fbs)),4)*100
table(data$restecg) #Glycémie élevé
round(prop.table(table(data$restecg)),4)*100
round(prop.table(table(data$thal)),4)*100
round(prop.table(table(data$target)),4)*100
